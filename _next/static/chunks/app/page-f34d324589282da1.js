(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{206:()=>{},832:()=>{},1372:()=>{},2548:(e,t,s)=>{Promise.resolve().then(s.bind(s,2994))},2712:(e,t,s)=>{"use strict";s.d(t,{n:()=>r});let r=["Рава-Руське","Потелицьке","Річківське","Михайлівське","Волицьке","Хлівчанське","Немирівське","Завадівське","Яворівське","Рогізнянське","Шклівське","Свидницьке"]},2994:(e,t,s)=>{"use strict";s.d(t,{default:()=>w});var r=s(5155),o=s(2115),a=s(4524),l=s(2502),n=s(9417),i=s(1540);let c=(e,t,s,r)=>{let o=n.utils.book_new(),a=n.utils.aoa_to_sheet([]),l=e.date?["Орієнтовний план реалізації на ".concat(new Date(e.date).toLocaleDateString("uk-UA"))]:["Орієнтовний план реалізації"];n.utils.sheet_add_aoa(a,[l],{origin:"A1"}),a.A1.s={fill:{fgColor:{rgb:"2DDB2D"}},font:{bold:!0,sz:22},alignment:{horizontal:"center",vertical:"center"}},a["!merges"]=a["!merges"]||[],a["!merges"].push({s:{r:0,c:0},e:{r:0,c:6}});let c=["№ п.п.","Підрозділ","Покупець","Найменування продукції","Порода","Орієнтовний об’єм (m\xb3)","Орієнтовна сума без ПДВ (грн)"];n.utils.sheet_add_aoa(a,[c],{origin:"A2"});let d=t.map((e,t)=>[t+1,e.forest,e.buyer,e.product,e.species,Math.round(e.volume),Math.round(e.amount)]);n.utils.sheet_add_aoa(a,d,{origin:"A3"});let m=["","","","","Всього:",Math.round(s),Math.round(r)];n.utils.sheet_add_aoa(a,[m],{origin:"A".concat(3+t.length)}),a["!cols"]=[{wch:8},{wch:15},{wch:35},{wch:25},{wch:15},{wch:25},{wch:30}];let p={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},x={font:{bold:!0},fill:{fgColor:{rgb:"00B047"}},border:p,alignment:{horizontal:"center",vertical:"center"}};c.forEach((e,t)=>{a[n.utils.encode_cell({r:1,c:t})]={v:c[t],t:"s",s:x}}),d.forEach((e,t)=>{c.forEach((e,s)=>{let r=n.utils.encode_cell({r:2+t,c:s});a[r]||(a[r]={}),a[r].s={...a[r].s,border:p,fill:{patternType:"solid",fgColor:{rgb:"EFF700"}},alignment:{horizontal:"center",vertical:"center"}}})}),m.forEach((e,s)=>{a[n.utils.encode_cell({r:2+t.length,c:s})]={v:e,t:s<5?"s":"n",s:{fill:{patternType:"solid",fgColor:{rgb:"00B047"}},border:p,alignment:{horizontal:"center",vertical:"center"},font:{bold:!0}}}}),n.utils.book_append_sheet(o,a,"Таблиця");let u=new Blob([n.write(o,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,i.saveAs)(u,"таблиця_".concat(e.date||"без_дати",".xlsx"))};var d=s(2712);function m(e){let{filter:t,setFilter:s,sortBy:o,handleSort:a}=e;return(0,r.jsxs)("div",{className:"mb-4 sm:mb-2 flex flex-col sm:flex-row gap-4 sm:gap-2 flex-wrap",children:[(0,r.jsx)("input",{type:"text",placeholder:"Фільтр за підрозділом",value:t.forest,onChange:e=>s({...t,forest:e.target.value}),className:"border px-2 py-1 sm:px-1 sm:py-0.5 rounded text-sm sm:text-xs md:text-base"}),(0,r.jsx)("input",{type:"text",placeholder:"Фільтр за покупцем",value:t.buyer,onChange:e=>s({...t,buyer:e.target.value}),className:"border px-2 py-1 sm:px-1 sm:py-0.5 rounded text-sm sm:text-xs md:text-base"}),(0,r.jsx)("input",{type:"text",placeholder:"Фільтр за породою",value:t.species,onChange:e=>s({...t,species:e.target.value}),className:"border px-2 py-1 sm:px-1 sm:py-0.5 rounded text-sm sm:text-xs md:text-base"}),(0,r.jsxs)("select",{value:o||"",onChange:e=>a(e.target.value),className:"border px-2 py-1 sm:px-1 sm:py-0.5 rounded text-sm sm:text-xs md:text-base",children:[(0,r.jsx)("option",{value:"",children:"Сортувати за..."}),(0,r.jsx)("option",{value:"volume",children:"Об’єм"}),(0,r.jsx)("option",{value:"amount",children:"Сума"})]})]})}let p=(0,o.memo)(e=>{let{row:t,idx:s}=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:s+1}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:t.forest}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:t.buyer}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:t.product}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:t.species}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:Math.round(t.volume)}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5",children:Math.round(t.amount)})]},"".concat(t.id,"-").concat(s))});function x(e){let{filteredAndSortedRows:t,totalVolume:s,totalAmount:o,sortBy:a,sortOrder:l,handleSort:n}=e;return(0,r.jsx)("div",{className:"overflow-x-auto mb-4 sm:mb-2",children:(0,r.jsxs)("table",{className:"min-w-full border text-[12px] sm:text-base text-left",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[40px] whitespace-normal",children:"№"}),(0,r.jsx)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[100px] whitespace-normal",children:"Лісництво"}),(0,r.jsx)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[100px] whitespace-normal",children:"Покупець"}),(0,r.jsx)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[120px] whitespace-normal",children:"Найменування продукції"}),(0,r.jsx)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[80px] whitespace-normal",children:"Порода"}),(0,r.jsxs)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[100px] whitespace-normal cursor-pointer",onClick:()=>n("volume"),children:["Орієнтовний об’єм (м\xb3) ","volume"===a&&("asc"===l?"↑":"↓")]}),(0,r.jsxs)("th",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 min-w-[120px] whitespace-normal cursor-pointer",onClick:()=>n("amount"),children:["Орієнтовна сума без ПДВ (грн) ","amount"===a&&("asc"===l?"↑":"↓")]})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>(0,r.jsx)(p,{row:e,idx:t},e.id))}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 font-bold",colSpan:5,children:"Всього:"}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 font-bold",children:Math.round(s)}),(0,r.jsx)("td",{className:"border px-2 py-1 sm:px-1 sm:py-0.5 font-bold",children:Math.round(o)})]})})]})})}p.displayName="RowComponent";var u=s(4065),h=s(8296);let b=()=>{let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e};function y(e){let{chartData:t}=e,s=(0,h.Ub)({maxWidth:640}),o={...t,datasets:t.datasets.map(e=>({...e,barThickness:30,categoryPercentage:.4}))},a=d.n.map(()=>b()),l={labels:t.labels,datasets:[{data:t.datasets[0].data,backgroundColor:a,borderColor:"#FFFFFF",borderWidth:1}]};return(0,r.jsx)("div",{className:"mt-4 ".concat(d.n.length>5?"h-[400px] sm:h-[300px]":"h-[300px] sm:h-[250px]"),children:s?(0,r.jsx)(u.Fq,{data:l,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:14},color:"#2E7D32"}},title:{display:!0,text:"Об’єм за підрозділами (м\xb3)",font:{size:18,weight:"bold"},color:"#2E7D32"}}}}):(0,r.jsx)(u.yP,{data:o,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:14},color:"#2E7D32"}},title:{display:!0,text:"Об’єм за підрозділами (м\xb3)",font:{size:18,weight:"bold"},color:"#2E7D32"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Об’єм (м\xb3)",font:{size:14},color:"#2E7D32"},ticks:{font:{size:12},color:"#4CAF50"},grid:{color:"#E0F2E9",lineWidth:.5}},x:{title:{display:!0,text:"Підрозділ",font:{size:14},color:"#2E7D32"},ticks:{font:{size:12},color:"#4CAF50",maxRotation:45,minRotation:45},grid:{display:!1}}},layout:{padding:{top:10,bottom:10,left:10,right:10}}}})})}function g(e){let{exportToExcel:t,showChart:s,setShowChart:o}=e;return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-2",children:[(0,r.jsx)("button",{onClick:t,className:"bg-green-500 text-white px-4 py-2 sm:px-3 sm:py-1 rounded hover:bg-green-600 sm:text-sm md:text-base",children:"⬇️ Завантажити в Excel"}),(0,r.jsxs)("button",{onClick:()=>o(!s),className:"bg-blue-500 text-white px-4 py-2 sm:px-3 sm:py-1 rounded hover:bg-blue-600 sm:text-sm md:text-base",children:["\uD83D\uDCCA ",s?"Приховати графік":"Показати графік"]})]})}function f(e){let{tables:t}=e,[s,a]=(0,o.useState)(t.map(()=>({forest:"",buyer:"",species:""}))),[l,n]=(0,o.useState)(t.map(()=>null)),[i,p]=(0,o.useState)(t.map(()=>"asc")),[u,h]=(0,o.useState)(t.map(()=>!1)),b=(e,t)=>{a(s=>{let r=[...s];return r[e]=t,r})},f=(e,t)=>{n(s=>{let r=[...s];return r[e]=t,r})},w=(e,t)=>{p(s=>{let r=[...s];return r[e]=t,r})},j=(e,t)=>{h(s=>{let r=[...s];return r[e]=t,r})},v=(0,o.useMemo)(()=>t.map((e,t)=>e.rows&&Array.isArray(e.rows)?e.rows.filter(e=>{var r,o,a;return e&&(null==(r=e.forest)?void 0:r.toLowerCase().includes(s[t].forest.toLowerCase()))&&(null==(o=e.buyer)?void 0:o.toLowerCase().includes(s[t].buyer.toLowerCase()))&&(null==(a=e.species)?void 0:a.toLowerCase().includes(s[t].species.toLowerCase()))}).sort((e,s)=>{let r=l[t];if(!r)return 0;let o=e[r],a=s[r];return"number"==typeof o&&"number"==typeof a?"asc"===i[t]?o-a:a-o:"asc"===i[t]?String(o).localeCompare(String(a)):String(a).localeCompare(String(o))}):[]),[t,s,l,i]),N=(0,o.useMemo)(()=>v.map(e=>({totalVolume:e.reduce((e,t)=>e+(t.volume||0),0),totalAmount:e.reduce((e,t)=>e+(t.amount||0),0)})),[v]),C=(0,o.useMemo)(()=>v.map(e=>{let t=d.n.map(t=>({forest:t,volume:e.filter(e=>e.forest===t).reduce((e,t)=>e+(t.volume||0),0)}));return{labels:t.map(e=>e.forest),datasets:[{label:"Об’єм (m\xb3)",data:t.map(e=>e.volume),backgroundColor:"#4CAF50",borderColor:"#2E7D32",borderWidth:1,barThickness:20,categoryPercentage:.5}]}}),[v]),A=(e,t)=>{l[e]===t?w(e,"asc"===i[e]?"desc":"asc"):(f(e,t),w(e,"asc"))},_=e=>{c(t[e],v[e],N[e].totalVolume,N[e].totalAmount)};return(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsxs)("div",{className:"mb-6 border rounded p-4 sm:p-2",children:[e.date&&(0,r.jsxs)("h2",{className:"text-xl sm:text-lg md:text-2xl font-bold mb-4 sm:mb-2",children:["Орієнтовний план реалізації на ",new Date(e.date).toLocaleDateString("uk-UA")," (Таблиця ",t+1,")"]}),(0,r.jsx)(m,{filter:s[t],setFilter:e=>b(t,e),sortBy:l[t],sortOrder:i[t],handleSort:e=>A(t,e)}),(0,r.jsx)(x,{filteredAndSortedRows:v[t],totalVolume:N[t].totalVolume,totalAmount:N[t].totalAmount,sortBy:l[t],sortOrder:i[t],handleSort:e=>A(t,e)}),(0,r.jsx)(g,{exportToExcel:()=>_(t),showChart:u[t],setShowChart:e=>j(t,e)}),u[t]&&(0,r.jsx)(y,{chartData:C[t]})]},t))})}function w(){let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{try{let e=(0,a.D)();t(e.tables||[])}catch(e){console.error("Помилка завантаження даних:",e),t([]),alert("Не вдалося завантажити дані.")}},[]),(0,r.jsx)("div",{className:"p-4 sm:p-2",children:0===e.length?(0,r.jsx)("p",{className:"text-center text-gray-500 text-base sm:text-sm md:text-lg",children:"Немає доступних таблиць для відображення."}):(0,r.jsx)(f,{tables:e})})}l.t1.register(l.E8,l.Bs,l.PP,l.kc,l.hE,l.m_,l.s$)},4163:()=>{},4388:()=>{},4524:(e,t,s)=>{"use strict";s.d(t,{D:()=>o,x:()=>r});let r=e=>{localStorage.setItem("tables",JSON.stringify(e.tables))},o=()=>{let e=localStorage.getItem("tables"),t=e?JSON.parse(e):[];if(Array.isArray(t)){let e=t.length>0?t[0]:{date:"",rows:[]};return{tables:t,date:e.date||"",rows:e.rows||[]}}return{tables:t.tables||[],date:t.date||"",rows:t.rows||[]}}},8569:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[647,558,787,770,767,441,684,358],()=>t(2548)),_N_E=e.O()}]);